> ### Kohana3框架简单入门  -- 非官方版本

***

* 目录结构

  - 入口文件  index.php
  
    - 设置application,module,cache,log,system等路径
    
      - 根目录:  `../app`
      - 加载的应用配置文件  `../app/config/app.php`
      - 框架模块目录     `../../framework/modules`
      - 框架系统目录     `../../framework/system`
      - 缓存目录         `cache`
      - log目录          `logs`
      - 跨域设置
      - 加载引导文件bootstrap.php      `../app/bootstrap.php`  
      - 设置Error reporting的等级
      - 最后一段代码判断是php的运行模式是cgi还是fpm-fcgi模式,现在基本上都是后者,下面是index.php结束后进行路由分发
        
        ```php
         echo Request::factory(TRUE, array(), FALSE)    //生成实例
             ->execute()                                //执行,其中进行了分发,调用了controller
             ->send_headers(TRUE)                       //给定头部
             ->body();                                  //得到request的一些参数
        ```

> ### MVC结构

  - C层
  
    - application/app/classes/Controller/
    
    for example:
    
    创建控制器文件 `application/classes/Controller/Hello.php`,写入下面类似代码
    ```php
    
    <?php defined('SYSPATH') OR die('No Direct Script Access');   // 阻止直接从网址访问文件
    
    Class Controller_Hello extends Controller
    {
    
        public function before()
	    {
            // 每个方法前执行
        }
    
    	public function action_index()
    	{
    		// echo 'hello, world!';
		
		    // $id = $this->request->param("id");       // 接受请求参数,控制器绑定了Request请求处理类
                                                     
		    $view = View::factory('smarty:article');  // 定义哪个模板,并通过工厂模式生成
            $data = 'hello, world';
            $view->set('data', $data);    //为模板绑定数据
            $this->response->body($view); //加载这个模板
        
            // url跳转
            // $this->redirect('/article/index.html');
            
            // 操作配置项
            $source_url = Panshi::config("app.source_url"); //获取config/app.php文件里的source_url项
                 
            // 调用数据库操作
            $mode = new Model_Article();
            $ret = $mode->saveApply($data);
        
            
    	}
	    // 访问地址`http://myapp.com/index.php/hello/index`或者`http://myapp.com/hello/`
 
	    public function after()
        {
            // 每个方法后执行
        }
    }
    ```
    
  - V层
  
    - application/views/article.tpl
  
  - M层
  
    - application/app/classes/Model/
    
    - 数据库相关操作
    
      - 插入记录
      
        ```php
        // DB::insert() 方法插入数据成功则会返回array();key为insert_id, value为影响的行数
        // for example:
        <?php
        try {
            list ($id, $rows) = DB::insert('AUTHORIZATION', array_keys($data))->values(array_values($data))->execute();
            return $rows;
        } catch (Exception $e) {
            return 0;
        }

        ```  
    ***   
      - 读取记录
      
      ```php
      
      ```
      
      
    

    
> 
  